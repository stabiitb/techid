<!DOCTYPE html>
<html lang="en">
{% include "head.html" %}
<body>
	{% include "navbar.html" %}
    <br/>
    <div class="row">
      <div class="container">
        <div class="col-lg-10 col-lg-offset-1">
          <div class="row">
            <div class="col-lg-12">
               <img class="img-responsive" src="http://placehold.it/1024X300">
            </div>
            {% if p == "success" %}
                <div class="alert alert-info"><Strong>Success!</strong>Registration Successfull</div>
            {% elif p == "already" %}
                <div class="alert alert-danger"><Strong>Warning!</strong>You have already registered</div>
            {% elif p == "error" %}
                <div class="alert alert-danger"><Strong>Warning!</strong>Cannot register to the event</div>
            {% endif %}
            <div class="col-lg-12">
              <div class="page-header">
                <h3>{{ event.name }} &nbsp;<span class="badge">{{ type }}</span>
                {% if type == "team" %}
                   <button type="button" class="btn btn-success pull-right" data-toggle="modal" data-target="#myModal">Register<span class="glyphicon glyphicon-chevron-right"></span></button> 
                {% elif type == "competition" %}
                 <form method="post" action="/event/register/" name="type" value="competition">{% csrf_token %}<button type="submit" name="eventid" value="{{ event.id }}" class="btn btn-success pull-right">Register <span class="glyphicon glyphicon-chevron-right"></span></button> </form>
                 {% endif %}
               </h3> 
              </div>
                  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                          <h4 class="modal-title" id="myModalLabel">Registration Status</h4>
                        </div>
                        <div class="modal-body">
                          <form role="form" id="myform">
                              <div class="form-group">
                                <label for="exampleInputEmail1">Teamname</label>
                                <input type="text" class="form-control" id="exampleInputEmail1" placeholder="Enter Your Teamname" name="teamname">
                                <hr>
                                <p class="text-center"> OR </p>
                                <label for="example">Team ID </label>
                                <input type="text" name="teamid" class="form-control" id="example" placeholder="enter Your Team Id">
                                <input type="hidden" name="eventid" value="{{ event.id }}" />
                              </div>
                              <button type="submit" class="btn btn-default">Submit</button>
                            </form>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                      </div><!-- /.modal-content -->
                    </div><!-- /.modal-dialog -->
                  </div><!-- /.modal -->


              <ul id="myTab" class="nav nav-tabs">
                <li class="active"><a href="#home" data-toggle="tab">Home</a></li>
                {% if type == "competition" or type == "team" %}
                <li class=""><a href="#reg" data-toggle="tab">Registered &nbsp;<span class="badge pull-right">{{ reg | length }}</span></a></li>
                {% endif %}
              </ul>

              <div id="myTabContent" class="tab-content">
                <div class="tab-pane fade active in" id="home">
                  <br/>
                  <h4>Description:</h4>
                  <p>{{ event.description }}</p>
                  <h4> Venue: </h4>
                  <p><span class="glyphicon glyphicon-map-marker"></span>  {{ event.venue }} </p>
                  <h4> Time : </h4>
                  <p><span class="glyphicon glyphicon-calendar"></span> {{ event.start_time }} </p>
                  <h4> Duration : </h4>
                  <p><span class="glyphicon glyphicon-time"></span> {{ event.duration }} </p>
                  <h4> Elligibilty : </h4>
                  <button type="button" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-star"></span> Year Elligibility: {{ event.year_elligible }}
                  </button>
                  <button type="button" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-star"></span> Dept Elligibility: {{ event.dept_elligible }}
                  </button>
                  <button type="button" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-star"></span> Hostel Elligibility: {{ event.hostel_elligible }}
                  </button>
                     {% if type == "concert" %}

                        <h4> Concert By: </h4>
                          <p> {{ concert.concertby }} </p>

                     {% elif type == "workshop" %}
                        <h4> Workshop By: </h4>
                        <p> {{ workshop.conductedby}} </h4>
                        <h4> Field of Workshop: </h4>
                        <p> %NAME% </p>
                     {% elif type == "lecture" %}
                      <h4> Lecture By: </h4>
                      <p> {{ workshop.field }} </p>
                   
                     {% elif type == "competition" %}
                      <h4>Dead line to register </h4>
                      <p><span class="glyphicon glyphicon-calendar"></span> {{ competition.deadline }} </span></p>
                    {% elif type == "team" %}
                      <h4>Dead line to register </h4>
                      <p><spanclass="glyphicon glyphicon-calendar"></span> {{ team.deadline }} </span></p>
                      <h4> Max Team Size </h4>
                      <p>{{ team.teamsize }}
                    {% endif %}
                 <h4><span class="label label-primary">%Event Type%</span></h4>

                </div>
                <div class="tab-pane fade" id="reg">
                  <br/>
                  <table class="table-bordered">
                    {% if not reg %}
                    <div class="alert alert-info"> No Registrations Yet </div>
                    {% else %}
                    <thead><tr><td>Studentname</td><td>RollNo</td></tr></thead>
                    <tbody>
                    {% for o in reg %}
                    <tr><td>{{ o.sid.name }}</td><td>{{ o.sid.rollno }}</td></tr>
                    {% endfor %}
                    {% endif %}
                    </tbody>
                  </table>
                </div>
            </div>


        </div>
      </div>
    </div>
  </div>
  	{% include "footer.html" %}
</div>
		<script type="text/javascript">
		$(document).ready(function() {
		    $("#myform").submit(function() {

		        $.ajax(
		                {
		                    type: 'POST',
		                    url: './register',
		                    data: {}, //your form datas to post          
		                    success: function(response)
		                    {
		                        alert(response);

		                    },
		                    error: function()
		                    {
		                        alert("Failure");
		                    }
		                });

		    });
		});

		</script>